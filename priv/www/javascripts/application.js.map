{"version":3,"file":"priv/assets/build/javascripts/application.js","sources":["app/ajax.spade.js","app/app.spade.js","app/artifacts.spade.js","app/help.spade.js","app/loading.spade.js","app/matrix.spade.js","app/polyfills.spade.js","app/projects.spade.js","app/raf.spade.js","app/results.spade.js","app/routes.spade.js","app/scorecards.spade.js"],"names":["minispade","register","normalizeRequestURL","url","split","recordRequest","event","jqXHR","settings","GiddyUp","activeAjax","context","render","removeRequest","$","document","ajaxSend","ajaxComplete","ajaxError","groupScorecards","scorecards","grouped","sortByName","sortBy","forEach","scorecard","version","parseVersion","push","sort","name","num_version","exec","digits","undefined","i","length","indexOnId","collection","reduce","acc","item","id","toString","extractPlatforms","tests","platforms","t","indexOf","platform","groupMatrix","matrix","p","resultsById","test_results","fetchProjects","cb","fetch","predicate","projects","shortcut","helpText","processor","result","projectsById","fetchScorecards","project","scorecardsById","fetchMatrix","testsById","fetchArtifacts","test_result","artifacts","artifactsById","fetchArtifactContents","artifact","contents","ajax","cache","accepts","text","content_type","dataType","options","ajaxOptions","callback","noop","requestOptions","type","nextGuid","callbacks","active","option","done","param","this","deferred","fail","console","log","arguments","window","showing","guid","prop","a","b","Nav","React","createClass","displayName","children","ProjectsNav","key","props","project_id","pid","ScorecardsNav","DOM","div","Main","getInitialState","test","componentDidMount","loadData","componentWillReceiveProps","nextProps","self","scorecard_id","test_instance_id","newState","setState","state","Results","Matrix","App","className","Help","content","help","Loading","queue","loading","requestAnimationFrame","renderComponent","getElementById","require","routie","navigateToHash","shortPath","path","slice","match","join","parseContentType","ctype","trim","ArtifactList","loaded","loadArtifacts","componentWillMount","friendlyUrl","coverageUrl","list","map","ArtifactLink","ul","li","href","span","artifact_id","klass","lookup","test_result_id","MediaIcon","major","minor","icon","ArtifactDisplay","findArtifact","tr","ArtifactElement","loadContents","img","src","pre","target","visible","handleClick","helpStyle","right","left","top","display","onClick","style","h3","title","body","code","em","test_instance","Object","keys","statusStyle","requests","k","req","loadMatrix","table","MatrixHeader","MatrixBody","scorecardId","headers","th","thead","rows","testname","MatrixRow","tbody","cells","MatrixCell","bubbles","unshift","td","MatrixBubble","resultStatus","status","bubbleBackgroundStyle","bubbleStatus","testResults","gradient","stepSize","red","green","st","idx","color","fgradient","prefix","background","every","some","bubbleClassName","classes","bubbleAbbreviation","parts","backend","upgrade_version","friendlyId","friendlyTestUrl","Array","prototype","find","defineProperty","enumerable","configurable","writable","value","ProjectNavLink","marginBottom","Date","now","getTime","vendors","vp","cancelAnimationFrame","navigator","userAgent","lastTime","nextTime","Math","max","setTimeout","clearTimeout","testDescription","desc","multi_config","timeAgoInWords","date","distance_in_seconds","distance_in_minutes","round","distance_in_hours","distance_in_days","distance_in_months","distance_in_years","description","scorecard_url","result_list","TestResult","h4","labelClass","labelText","liClass","created_at","long_version","hash","location","substring","encodeURIComponent","extractTestId","segment","decodeURIComponent","projects /","project /projects/:project_id","scorecard /projects/:project_id/scorecards/:scorecard_id","s","test_instance /projects/:project_id/scorecards/:scorecard_id/:test_instance_id","ti","test_result /projects/:project_id/scorecards/:scorecard_id/:test_instance_id/:test_result_id","artifact /projects/:project_id/scorecards/:scorecard_id/:test_instance_id/:test_result_id/artifacts/:artifact_id","links","dropdown","ScorecardNavGroup","reverse","l","marginTop","lastEvent","linkText","evt","nativeEvent","preventDefault","handleDocumentClick","addEventListener","componentWillUnmount","removeEventListener","ScorecardNavLink","classname"],"mappings":"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","sourcesContent":["minispade.register('ajax', function(){\n/*\n * Global Ajax Handlers\n */\n\nvar normalizeRequestURL = function(url){\n    return url.split(\"?\")[0];\n};\n\nvar recordRequest = function(event, jqXHR, settings){\n    var url = normalizeRequestURL(settings.url);\n    GiddyUp.activeAjax[url] = settings.context;\n    GiddyUp.render();\n};\n\nvar removeRequest = function(event, jqXHR, settings){\n    var url = normalizeRequestURL(settings.url);\n    delete GiddyUp.activeAjax[url];\n    GiddyUp.render();\n};\n\n$(document).ajaxSend(recordRequest);\n$(document).ajaxComplete(removeRequest);\n$(document).ajaxError(removeRequest);\n\n/*\n * Utility functions for massaging received data\n */\n\nvar groupScorecards = function(scorecards){\n    var grouped = {},\n        sortByName = GiddyUp.sortBy('name');\n    scorecards.forEach(function(scorecard){\n        var version = parseVersion(scorecard);\n        if(version in grouped){\n            grouped[version].push(scorecard);\n            grouped[version].sort(sortByName);\n        } else {\n            grouped[version] = [scorecard];\n        }\n    });\n    return grouped;\n};\n\nvar parseVersion = function(scorecard){\n    var name = scorecard.name,\n        num_version = /\\d+(?:\\.\\d+)+/.exec(name),\n        digits;\n\n    if(num_version === undefined || num_version === null){\n        return name;\n    } else {\n        num_version = num_version[0];\n        digits = num_version.split('.');\n        for(var i = 0; i < (3 - digits.length); i++){\n            num_version += \".0\";\n        }\n        return num_version;\n    }\n};\n\nvar indexOnId = function(collection){\n    return collection.reduce(function(acc, item){\n        acc[item.id.toString()] = item;\n        acc[item.id] = item;\n        return acc;\n    }, {});\n};\n\nvar extractPlatforms = function(tests){\n    return tests.reduce(function(platforms, t){\n        if (platforms.indexOf(t.platform) === -1)\n            platforms.push(t.platform);\n        return platforms;\n    }, []).sort();\n};\n\nvar groupMatrix = function(tests, platforms) {\n    return tests.reduce(function(matrix, t){\n        if(!(t.name in matrix)){\n            matrix[t.name] = {};\n            platforms.forEach(function(p){\n                matrix[t.name][p] = [];\n            });\n        };\n        t.resultsById = indexOnId(t.test_results);\n        matrix[t.name][t.platform].push(t);\n        return matrix;\n    }, {});\n};\n\n\n/*\n * Fetchers\n */\nGiddyUp.fetchProjects = function(cb){\n    GiddyUp.fetch({\n        url: \"/projects\",\n        predicate: (GiddyUp.projects.length > 0),\n        shortcut: GiddyUp.projects,\n        helpText: \"Projects list\",\n        processor: function(result){\n            var projects = result['projects'].sort(GiddyUp.sortBy('name'));\n            GiddyUp.projects = projects;\n            projects.forEach(function(p){\n                GiddyUp.projectsById[p.name] = p;\n            });\n            return projects;\n        }\n    }, cb);\n};\n\nGiddyUp.fetchScorecards = function(project, cb){\n    GiddyUp.fetch({\n        url: \"/projects/\"+project.name+\"/scorecards\",\n        predicate: ('scorecards' in project),\n        shortcut: project.scorecards,\n        helpText: \"Scorecards for '\" + project.name + \"'\",\n        processor: function(result){\n            project.scorecardsById = indexOnId(result['scorecards']);\n            project.scorecards = groupScorecards(result['scorecards']);\n            return project.scorecards;\n        }\n    }, cb);\n};\n\nGiddyUp.fetchMatrix = function(scorecard, cb) {\n    GiddyUp.fetch({\n        url: \"/scorecards/\"+scorecard.id.toString()+\"/matrix\",\n        predicate: ('tests' in scorecard),\n        shortcut: scorecard,\n        helpText: \"Test matrix for '\" + scorecard.project + \" \" + scorecard.name + \"'\",\n        processor: function(result){\n            scorecard.platforms = extractPlatforms(result['tests']);\n            scorecard.tests = groupMatrix(result['tests'],\n                                          scorecard.platforms);\n            scorecard.testsById = indexOnId(result['tests']);\n            return scorecard;\n        }\n    }, cb);\n};\n\nGiddyUp.fetchArtifacts = function(test_result, cb){\n    GiddyUp.fetch({\n        url: \"/test_results/\"+test_result.id+\"/artifacts\",\n        predicate: ('artifacts' in test_result),\n        shortcut: test_result.artifacts,\n        helpText: \"Artifacts for result \" + test_result.id,\n        processor: function(result){\n            test_result.artifacts = result['artifacts'].sort(GiddyUp.sortBy('id'));\n            test_result.artifactsById = indexOnId(test_result.artifacts);\n            return test_result.artifacts;\n        }\n    }, cb);\n};\n\nGiddyUp.fetchArtifactContents = function(artifact, cb) {\n    GiddyUp.fetch({\n        url: \"/artifacts/\"+artifact.id,\n        predicate: ('contents' in artifact),\n        shortcut: artifact.contents,\n        helpText: \"Contents of artifact \" + artifact.id,\n        processor: function(result){\n            artifact.contents = result;\n            return result;\n        },\n        ajax: {\n            cache: false,\n            accepts: {\"text\": artifact.content_type},\n            dataType: \"text\"\n        }\n    }, cb);\n};\n\nGiddyUp.fetch = function(options, cb) {\n    var url = options.url,\n        predicate = options.predicate,\n        shortcut = options.shortcut,\n        helpText = options.helpText,\n        processor = options.processor,\n        ajaxOptions = options.ajax || {},\n        callback = cb || $.noop,\n        requestOptions = {\n            type: \"GET\",\n            dataType: \"json\",\n            url: url,\n            context: {\n                id: GiddyUp.nextGuid(),\n                helpText: helpText,\n                callbacks: [callback]\n            }\n        },\n        active = GiddyUp.activeAjax[url];\n\n    if(predicate){\n        callback(shortcut);\n    } else if (active) {\n        active.callbacks.push(callback);\n    } else {\n        var option;\n        for(option in ajaxOptions){\n            requestOptions[option] = ajaxOptions[option];\n        }\n        $.ajax(requestOptions).done(function(result){\n            var param = processor(result);\n            this.callbacks.forEach(function(deferred){ deferred(param); });\n        }).fail(function(){ console.log(arguments) });\n        GiddyUp.render(); // Render the loading box\n    }\n};\n});\n","minispade.register('app', function(){\n/** @jsx React.DOM */\nvar GiddyUp = window.GiddyUp = {\n    projects: [],\n    projectsById: {},\n    showing: {},\n    activeAjax: {},\n    guid: 0\n};\n\nGiddyUp.nextGuid = function(){\n    GiddyUp.guid += 1;\n    return GiddyUp.guid;\n};\n\nGiddyUp.sortBy = function(prop) {\n    return function(a,b) {\n        if(a[prop] < b[prop]) return -1;\n        if(a[prop] > b[prop]) return 1;\n        return 0;\n    };\n};\n\nNav = React.createClass({displayName: 'Nav',\n    render: function(){\n        var children = [ProjectsNav( {key:\"projects\",\n                        showing:this.props.showing} )];\n\n        if(this.props.showing.project_id) {\n            var pid = this.props.showing.project_id;\n            var project = GiddyUp.projectsById[pid];\n            if(project){\n                children.push(ScorecardsNav( {key:pid + \"/scorecards\",\n                              project:project,\n                              showing:this.props.showing} ));\n            }\n        }\n        return (React.DOM.div(null, children));\n    }\n});\n\nMain = React.createClass({displayName: 'Main',\n  getInitialState: function(){\n    return {\n        project: undefined,\n        scorecard: undefined,\n        test: undefined\n    };\n  },\n  componentDidMount: function(){\n      this.loadData(this.props.showing);\n  },\n  componentWillReceiveProps: function(nextProps){\n      if(nextProps.showing !== this.props.showing){\n          this.loadData(nextProps.showing);\n      }\n  },\n  loadData: function(showing){\n      var self = this,\n          project, scorecard, test;\n      GiddyUp.fetchProjects(function(projects){\n          project = GiddyUp.projectsById[showing.project_id];\n          if(showing.project_id && project){\n              GiddyUp.fetchScorecards(project, function(scorecards){\n                  scorecard = project.scorecardsById[showing.scorecard_id];\n                  if(showing.test_instance_id && scorecard.testsById){\n                      test = scorecard.testsById[showing.test_instance_id];\n                  }\n                  var newState = {project: project,\n                                 scorecard: scorecard,\n                                 test: test};\n                  self.setState(newState);\n              });\n          } else {\n              self.setState({project: project,\n                             scorecard: scorecard,\n                             test: test});\n          }\n      });\n  },\n  render: function(){\n      var showing = this.props.showing;\n      var project = this.state.project,\n          scorecard = this.state.scorecard,\n          test = this.state.test;\n      if(project && scorecard){\n          if(test){\n              return (Results( {scorecard:scorecard,\n                      showing:showing, test:test} ));\n          } else {\n              return (Matrix( {scorecard:scorecard} ));\n          }\n      } else {\n          return React.DOM.div(null );\n      }\n  }\n});\n\nApp = React.createClass({displayName: 'App',\n    render: function(){\n        return (\n                React.DOM.div( {className:\"container-fluid\"}, \n                  Nav( {showing:this.props.showing} ),\n                  Help( {content:Help[this.props.help]} ),\n                  Loading( {queue:this.props.loading} ),\n                  Main( {showing:this.props.showing} )\n                )\n        );\n    }\n});\n\nGiddyUp.render = function() {\n    window.requestAnimationFrame(function(){\n        React.renderComponent(App( {showing:GiddyUp.showing,\n                                   help:GiddyUp.help,\n                                   loading:GiddyUp.activeAjax} ),\n                              document.getElementById('app'));\n    });\n};\n\nminispade.require('polyfills');\nminispade.require('ajax');\nminispade.require('help');\nminispade.require('loading');\nminispade.require('projects');\nminispade.require('scorecards');\nminispade.require('matrix');\nminispade.require('results');\nminispade.require('artifacts');\nminispade.require('raf');\nminispade.require('routes');\n\nroutie.navigateToHash();\n});\n","minispade.register('artifacts', function(){\n/** @jsx React.DOM **/\nvar shortPath = function(url){\n  // We want to extract the shortest meaningful path from the given\n  // URL. For now we assume the file will either be named \"ID.log\"\n  // where ID is a number, or \"ID/some/deep/path/to/tehfile.bmp\". For\n  // the former, just return the full thing, for the latter, strip off\n  // the ID prefix.\n  if(url === undefined || url === null)\n    return '';\n\n  var path = url.split(\"/\").slice(3);\n  if(path[0].match(\"^[0-9]+$\"))\n    return path.slice(1).join(\"/\");\n  else\n    return path.join('/');\n};\n\nvar parseContentType = function(ctype){\n    return ctype.toString().split(\";\")[0].trim().split(\"/\");\n};\n\nArtifactList = React.createClass({displayName: 'ArtifactList',\n    getInitialState: function(){\n        return { loaded: false };\n    },\n    loadArtifacts: function(){\n        var self = this;\n        GiddyUp.fetchArtifacts(this.props.test_result,\n                               function(artifacts){\n                                   self.setState({ loaded: true });\n                               });\n    },\n    componentWillMount: function(){\n        if(this.props.active){\n            this.loadArtifacts();\n        }\n    },\n    componentWillReceiveProps: function(nextProps){\n        if(nextProps.active && !this.state.loaded)\n            this.loadArtifacts();\n    },\n    render: function(){\n        var active = this.props.active,\n            loaded = this.state.loaded,\n            showing = this.props.showing,\n            artifacts = this.props.test_result.artifacts,\n            friendlyUrl = this.props.friendlyUrl,\n            coverageUrl = '/test_results/' + this.props.test_result.id + '/coverage';\n        if(active && loaded){\n            var list = artifacts.map(function(a){\n                return ArtifactLink( {showing:showing,\n                        key:a.id, artifact:a, friendlyUrl:friendlyUrl});\n            });\n            return React.DOM.ul( {className:\"nav nav-list\"}, \n                    React.DOM.li(null, React.DOM.a( {href:coverageUrl}, \"Coverage\")),\n                    list);\n        } else {\n            return React.DOM.span(null );\n        }\n    }\n});\n\nArtifactLink = React.createClass({displayName: 'ArtifactLink',\n    render: function(){\n        var artifact = this.props.artifact,\n            showing = this.props.showing,\n            active = (showing.artifact_id === artifact.id.toString()),\n            klass = (active) ? \"active\" : \"\",\n            friendlyUrl = this.props.friendlyUrl,\n            url;\n        url = '#' + routie.lookup('artifact',\n                                  {project_id: showing.project_id,\n                                   scorecard_id: showing.scorecard_id,\n                                   test_instance_id: friendlyUrl,\n                                   test_result_id: showing.test_result_id,\n                                   artifact_id: artifact.id});\n        return (React.DOM.li( {className:klass}, \n                  React.DOM.a( {href:url}, \n                    MediaIcon( {ctype:artifact.content_type} ),\n                    shortPath(artifact.url)\n                  )\n                ));\n    }\n});\n\n\nMediaIcon = React.createClass({displayName: 'MediaIcon',\n    render: function(){\n        var ctype = this.props.ctype,\n            type = parseContentType(ctype),\n            major = type[0],\n            minor = type[1],\n            icon;\n\n        if(major === 'image'){\n            icon = 'icon-picture';\n        } else if(major === 'text') {\n            if(minor === 'csv'){\n                icon = 'icon-th';\n            } else {\n                icon = 'icon-pencil';\n            }\n        } else {\n            icon = 'icon-file';\n        }\n        return (React.DOM.i( {className:icon} ));\n    }\n});\n\nArtifactDisplay = React.createClass({displayName: 'ArtifactDisplay',\n    findArtifact: function(test, test_result_id, artifact_id){\n        var test_result = undefined,\n            artifact = undefined;\n        test.test_results.forEach(function(tr){\n            if(tr.id.toString() === test_result_id){\n                test_result = tr;\n            }\n        });\n        if(test_result && test_result.artifactsById){\n            artifact = test_result.artifactsById[artifact_id];\n        }\n        return artifact;\n    },\n    render: function(){\n        var showing = this.props.showing,\n            artifact;\n        if(showing.artifact_id){\n            artifact = this.findArtifact(this.props.test,\n                                         showing.test_result_id,\n                                         showing.artifact_id);\n            if(artifact === undefined || artifact === null){\n                return React.DOM.div( {className:\"span9 well\"}, \"Loading...\")\n            } else {\n                return (React.DOM.div( {className:\"span9\"}, ArtifactElement( {artifact:artifact} )));\n            }\n        } else {\n            return (React.DOM.div( {className:\"span9 well\"}, \"Select a test artifact to view its contents.\"));\n        }\n    }\n});\n\nArtifactElement = React.createClass({displayName: 'ArtifactElement',\n    getInitialState: function(){\n        return { text: undefined };\n    },\n    componentWillMount: function(){\n        var artifact = this.props.artifact;\n        this.loadContents(artifact);\n    },\n    componentWillReceiveProps: function(nextProps){\n        if(this.props.artifact !== nextProps.artifact){\n            this.setState({text: undefined});\n            this.loadContents(nextProps.artifact);\n        }\n    },\n    loadContents: function(artifact){\n       var major = parseContentType(artifact.content_type)[0],\n           self = this;\n        if(major === 'text') {\n            GiddyUp.fetchArtifactContents(artifact, function(t){\n                self.setState({ text: t });\n            });\n        }\n    },\n    render: function(){\n        var artifact = this.props.artifact,\n            major = parseContentType(artifact.content_type)[0];\n\n        if(major === 'image'){\n            return React.DOM.img( {src:artifact.url} );\n        } else if (major === 'text') {\n            if(this.state.text !== undefined){\n                return React.DOM.pre( {className:\"unabridged\"}, this.state.text);\n            } else {\n                return React.DOM.pre( {className:\"unabridged\"}, \"Loading...\");\n            }\n        } else {\n            return (React.DOM.p(null, \n                    React.DOM.i( {className:\"icon-download\"}),\n                    React.DOM.a( {target:\"_blank\", href:artifact.url}, \"Download this artifact\")\n                    ));\n        }\n    }\n});\n});\n","minispade.register('help', function(){\n/** @jsx React.DOM */\nHelp = React.createClass({displayName: 'Help',\n    getInitialState: function(){\n        return {visible: false};\n    },\n    handleClick: function(event){\n        this.setState({visible: !this.state.visible});\n    },\n    render: function(){\n        var helpStyle = {\n            right: \"110px\",\n            left: \"auto\",\n            top: \"40px\",\n            display: this.state.visible ? \"block\" : \"none\"\n        };\n        return React.DOM.div(null, \n                 React.DOM.img( {className:\"cowboy\", src:\"/images/cowboy.png\", onClick:this.handleClick} ),\n                 React.DOM.div( {id:\"help\", className:\"popover left\", style:helpStyle}, \n                   React.DOM.div( {className:\"arrow\", style:{top: 48}} ),\n                     React.DOM.h3( {className:\"popover-title\"}, this.props.content.title),\n                     React.DOM.div( {className:\"popover-content\"}, this.props.content.body)\n                  )\n              );\n    }\n});\n\n\nHelp.projects = {\n    title: \"Welcome to GiddyUp!\",\n    body: React.DOM.div(null, React.DOM.p( {key:\"projects1\"}, \"GiddyUp is an API and user-interface to test results we collect\"+' '+\n                   \"from \", React.DOM.code(null, \"riak_test\"),\". I'm your guide, \", React.DOM.em(null, \"Artie\"),\", the\"+' '+\n                   \"Lone Testing Ranger.\"),\n                React.DOM.p( {key:\"projects2\"}, \"To get started, click a project to see which versions we've wrangled.\"))\n};\n\nHelp.project = {\n  title: \"Yeehaw!\",\n  body: React.DOM.p(null, \"These are all the versions we've tested on the project, which I\"+' '+\n            \"reckon are called scorecards. Click one in the second row to see a\"+' '+\n            \"matrix of its results.\")\n};\n\nHelp.scorecard = {\n  title: \"Lookout, stampede!\",\n  body: React.DOM.div(null, \n  React.DOM.p(null, \"Y'er looking at the results of test runs for a single project\"+' '+\n\"version.\"),\n\nReact.DOM.p(null, \"Down the leftmost column are the test names that were run. Across\"+' '+\n  \"the top are the platforms the tests were run against.\"),\n\nReact.DOM.p(null, \"The colored bubbles indicate whether the latest run was a \", React.DOM.span(\n   {className:\"badge badge-success\"}, \"pass\"), \" or a \", React.DOM.span( {className:\"badge\"+' '+\n   \"badge-important\"}, \"failure\"),\". Tests that have no results\"+' '+\n   \"recorded are \", React.DOM.span( {className:\"badge\"}, \"gray\"),\". While we're still\"+' '+\n   \"counting the steers, the bubble will be \", React.DOM.span( {className:\"badge\"+' '+\n   \"badge-loading\"}, React.DOM.a(null, \"outlined\")),\".\"),\n\nReact.DOM.p(null, \"The text in the bubble tells ye' the parameters for the\"+' '+\n\"test:\"),\n\nReact.DOM.ul(null, \n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"U\"), \" Default backend\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"B\"), \" Bitcask backend\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"L\"), \" LevelDB backend\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"M\"), \" Memory backend\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"N\"), \" Multi-backend\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"-1\"), \" Upgraded from previous\"),\n  React.DOM.li(null,  \" \", React.DOM.span( {className:\"badge\"}, \"-2\"), \" Upgraded from legacy\")\n),\n\nReact.DOM.p(null, \"Ye' can click a bubble to see the results we got in the corral.\"))\n\n};\n\nHelp.test_instance = {\n  title: \"Have a look-see\",\n  body: React.DOM.div(null,   \"  \",  React.DOM.p(null, \"We herded these here test results into the corral for ye'.\"),\n\n  React.DOM.p(null, \"Down the left side are all the results, whether they be good or\"+' '+\n    \"bad, how old they are, and which brood \", React.DOM.em(null, \"erm\"), \" version they\"+' '+\n    \"came from. Select one and ye'll see its output on the right.\"))\n\n};\n\nHelp.test_result = {\n  title: \"Git along, lil' dogie!\",\n  body: React.DOM.p(null, \"We herded a number for ye' from the time that there test was run.\"+' '+\n  \"Click an artifact to get an ideer of how things transpired.\")\n};\n\nHelp.artifact = {\n  title: \"Whoa, boy!\",\n  body: React.DOM.div(null,   \"  \",  React.DOM.p(null, \"That there is a lot of stuff! riak_test uses lots of four-dollar\"+' '+\n  \"words, I tell ye'.\"),\n\n  React.DOM.p(null, \"Scroll down to see the rest of the output if the thing you've\"+' '+\n  \"selected is text. Otherwise just have a look at the pretty\"+' '+\n  \"picture!\"))\n};\n});\n","minispade.register('loading', function(){\n/** @jsx React.DOM */\nLoading = React.createClass({displayName: 'Loading',\n    render: function(){\n        var queue = this.props.queue,\n            length = Object.keys(queue).length,\n            statusStyle = {\n                right: \"10px\",\n                left: \"auto\",\n                top: \"140px\",\n                display: (length > 0) ? \"block\" : \"none\"\n            },\n            requests = Object.keys(queue).map(function(k){\n                var req = queue[k];\n                return (React.DOM.li( {key:req.id},  \" - \", req.helpText, \" \" ));\n            });\n        return (\n            React.DOM.div( {className:\"popover bottom\", style:statusStyle}, \n              React.DOM.div( {className:\"arrow\", style:{left: \"75%\"}}),\n              React.DOM.h3( {className:\"popover-title\"}, \"Hold yer horses!\"),\n              React.DOM.div( {className:\"popover-content\"}, \n                React.DOM.p(null, \"I've got \", React.DOM.span( {className:\"text-info\"},  \" \", length, \" \" ),\n                \"more steers to herd.\"),\n                React.DOM.ul( {className:\"unstyled\"},  \" \",  requests,  \" \" )\n              )\n            )\n        );\n    }\n});\n});\n","minispade.register('matrix', function(){\n/** @jsx React.DOM */\nMatrix = React.createClass({displayName: 'Matrix',\n    getInitialState: function(){\n        return {loaded: false};\n    },\n    componentDidMount: function(){\n        this.loadMatrix(this.props.scorecard);\n    },\n    componentWillReceiveProps: function(nextProps) {\n        if(this.props.scorecard !== nextProps.scorecard){\n            this.setState({loaded: false});\n            this.loadMatrix(nextProps.scorecard);\n        }\n    },\n    render: function() {\n        return (this.state.loaded) ? (\n            React.DOM.table( {className:\"table table-striped\", key:this.props.scorecard.id}, \n                MatrixHeader( {platforms:this.props.scorecard.platforms,\n                              scorecard:this.props.scorecard} ),\n                MatrixBody( {scorecard:this.props.scorecard,\n                    platforms:this.props.scorecard.platforms,\n                    tests:this.props.scorecard.tests} )\n            )\n        ) : (React.DOM.table( {className:\"table table-striped\", key:this.props.scorecard.id}));\n    },\n    loadMatrix: function(scorecard) {\n        var self = this;\n        GiddyUp.fetchMatrix(scorecard, function(){ self.setState({ loaded: true });  });\n    }\n});\n\nMatrixHeader = React.createClass({displayName: 'MatrixHeader',\n    render: function(){\n        var scorecardId = this.props.scorecard.id;\n        var headers = this.props.platforms.map(function(p){return (React.DOM.th( {key:p}, React.DOM.a( {href:\"/scorecards/\" + scorecardId + \"/\" + p + \"/coverage\"}, p))); });\n        return (React.DOM.thead(null, \n                React.DOM.th(null, React.DOM.a( {href:\"/scorecards/\" + scorecardId + \"/coverage\"}, \"Combined Coverage\")),\n                headers\n                ));\n    }\n});\n\nMatrixBody = React.createClass({displayName: 'MatrixBody',\n    render: function(){\n        var rows = [];\n        for(testname in this.props.tests){\n            rows.push(MatrixRow( {scorecard:this.props.scorecard,\n                                 key:testname,\n                                 test:this.props.tests[testname],\n                                 platforms:this.props.platforms} ));\n        }\n        return (React.DOM.tbody(null,  \" \", rows, \" \" ));\n    }\n});\n\nMatrixRow = React.createClass({displayName: 'MatrixRow',\n    render: function(){\n        var cells = [];\n        var props = this.props;\n        props.platforms.forEach(function(p){\n            var platform = props.test[p];\n            cells.push(MatrixCell( {key:p, bubbles:platform,\n                       scorecard:props.scorecard} ));\n        });\n        cells.unshift(React.DOM.td( {key:\"title\"}, this.props.key));\n        return (React.DOM.tr(null,  \" \", cells, \" \" ));\n    }\n});\n\nMatrixCell = React.createClass({displayName: 'MatrixCell',\n    render: function() {\n        var props = this.props,\n            bubbles = props.bubbles.map(function(b){\n                return (MatrixBubble( {key:b.id, test:b,\n                                      scorecard:props.scorecard} ));\n            });\n        return (React.DOM.td(null, bubbles));\n    }\n});\n\nvar resultStatus = function(tr){ return tr.status; };\n\nvar bubbleBackgroundStyle = function(test){\n    var status = bubbleStatus(test),\n        testResults, gradient, stepSize,\n        red = \"#b94a48\", green = \"#468847\";\n    if(status === 'warning'){\n      testResults = test.test_results.map(resultStatus).slice(0,4);\n      stepSize = 100 / test.test_results.length;\n      gradient = \"linear-gradient(right\";\n      testResults.forEach(function(st, idx){\n        var color = (st === true) ? green : red;\n        gradient += \", \" + color + \" \" + (stepSize * idx) + \"%\";\n        gradient += \", \" + color + \" \" + (stepSize * (idx+1)) + \"%\";\n      });\n      gradient += \")\";\n      var fgradient = [\"-moz-\", \"-ms-\", \"-o-\", \"-webkit-\", \"\"].map(\n          function(prefix){ return \"background-image: \" + prefix +\n                            gradient; }).join(\"; \");\n      // ugly hack because React or DOM doesn't allow multiple\n      // elements of the same style\n      return {background: \"inherit; \" + fgradient};\n    } else {\n      return {};\n    }\n};\n\nvar bubbleStatus = function(test){\n    if(test.test_results.length === 0){\n        return null;\n    } else {\n        if(test.test_results.every(resultStatus)){\n            return true;\n        }\n        if(test.test_results.some(resultStatus)){\n            return 'warning';\n        }\n        return false;\n    }\n};\n\nvar bubbleClassName = function(test){\n    var status = bubbleStatus(test),\n        classes = ['badge'];\n\n    if(status === true) {\n      classes.push('badge-success');\n    }\n    if(status === false) {\n      classes.push('badge-important');\n    }\n    if(status === 'warning') {\n      classes.push('badge-warning');\n    }\n    if(status === undefined) {\n      classes.push('badge-loading');\n    }\n    return classes.join(' ');\n};\n\nvar bubbleAbbreviation = function(test){\n    var parts = [];\n    switch(test.backend){\n    case 'bitcask':\n        parts.push('B'); break;\n    case 'eleveldb':\n        parts.push('L'); break;\n    case 'memory':\n        parts.push('M'); break;\n    case 'multi':\n        parts.push('N'); break;\n    default:\n        break;\n    }\n\n    switch(test.upgrade_version){\n    case 'previous':\n        parts.push('-1'); break;\n    case 'legacy':\n        parts.push('-2'); break;\n    default:\n        break;\n    }\n\n    if (parts.length === 0)\n        return 'U';\n    else\n        return parts.join('');\n};\n\nMatrixBubble = React.createClass({displayName: 'MatrixBubble',\n    render: function() {\n        var friendlyId = friendlyTestUrl(this.props.scorecard, this.props.test),\n            url = ('#' + routie.lookup('test_instance', {\n                project_id: this.props.scorecard.project,\n                scorecard_id: this.props.scorecard.id,\n                test_instance_id: friendlyId}));\n        return (React.DOM.div(null, \n                  React.DOM.span( {className:bubbleClassName(this.props.test),\n                        style:bubbleBackgroundStyle(this.props.test)}, \n                     React.DOM.a( {href:url}, bubbleAbbreviation(this.props.test))\n                  )\n                ));\n    }\n});\n});\n","minispade.register('polyfills', function(){\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\nif (!Array.prototype.find) {\n  Object.defineProperty(Array.prototype, 'find', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function(predicate) {\n      for (var i=0; i < this.length; i++) {\n        if (predicate(this[i], i, this)) {\n          return this[i];\n        }\n      }\n      return void 0;\n    }\n  });\n}\n});\n","minispade.register('projects', function(){\n/** @jsx React.DOM */\n\nProjectsNav = React.createClass({displayName: 'ProjectsNav',\n    getInitialState: function(){\n        return { projects: GiddyUp.projects };\n    },\n    componentWillMount: function(){\n        var self = this;\n        GiddyUp.fetchProjects(function(projects){\n            self.setState({\n                projects: projects\n            });\n        });\n    },\n    render: function() {\n        var self = this;\n        var projects = this.state.projects.map(function(project) {\n            var key = project.name;\n            return ProjectNavLink( {key:key, project:project, showing:self.props.showing});\n        });\n        return (\n                React.DOM.div( {className:\"navbar\", style:{marginBottom: 0}} , \n                  React.DOM.div( {className:\"navbar-inner\"}, \n                    React.DOM.a( {href:\"#/\", className:\"brand\"}, \"GiddyUp\"),\n                    React.DOM.ul( {className:\"nav\"}, projects)\n                  )\n                )\n        );\n    }\n});\n\nProjectNavLink = React.createClass({displayName: 'ProjectNavLink',\n    render: function(){\n        var url = '#' + routie.lookup('project', {project_id: this.props.project.name});\n        return (React.DOM.li( {className:(this.props.showing.project_id ===\n                                this.props.project.name) ? \"active\" : \"\"}, \n                  React.DOM.a( {href:url},  \" \", this.props.project.name, \" \" )\n                ));\n    }\n});\n});\n","minispade.register('raf', function(){\n'use strict';\n\n// Adapted from https://gist.github.com/paulirish/1579671 which derived from \n// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n\n// requestAnimationFrame polyfill by Erik Mller.\n// Fixes from Paul Irish, Tino Zijdel, Andrew Mao, Klemen Slavi, Darius Bacon\n\n// MIT license\n\nif (!Date.now)\n    Date.now = function() { return new Date().getTime(); };\n\n(function() {\n    if(window.requestAnimationFrame)\n      return;\n    var vendors = ['webkit', 'moz'];\n    for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\n        var vp = vendors[i];\n        window.requestAnimationFrame = window[vp+'RequestAnimationFrame'];\n        window.cancelAnimationFrame = (window[vp+'CancelAnimationFrame']\n                                   || window[vp+'CancelRequestAnimationFrame']);\n    }\n    if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) // iOS6 is buggy\n        || !window.requestAnimationFrame || !window.cancelAnimationFrame) {\n        var lastTime = 0;\n        window.requestAnimationFrame = function(callback) {\n            var now = Date.now();\n            var nextTime = Math.max(lastTime + 16, now);\n            return setTimeout(function() { callback(lastTime = nextTime); },\n                              nextTime - now);\n        };\n        window.cancelAnimationFrame = clearTimeout;\n    }\n}());\n});\n","minispade.register('results', function(){\n/** @jsx React.DOM */\n\nvar testDescription = function(test){\n    var desc = [];\n\n    if(test.name) desc.push(test.name);\n    if(test.platform) desc.push(test.platform);\n    if(test.backend) desc.push(test.backend);\n    if(test.upgrade_version) desc.push(test.upgrade_version);\n    if(test.multi_config) desc.push(test.multi_config);\n    return desc.join(\" / \");\n};\n\nvar timeAgoInWords = function(date){\n  // Based roughly on distance_of_time_in_words from Ruby on Rails,\n  // with ideas from John Resig's \"prettyDate\" function.\n  if(date === undefined || date === null)\n    return '';\n\n  var now = (new Date()).getTime(),\n      distance_in_seconds = (now - date.getTime()) / 1000,\n      distance_in_minutes = Math.round(distance_in_seconds / 60.0),\n      distance_in_hours = Math.round(distance_in_minutes / 60.0),\n      distance_in_days = Math.round(distance_in_minutes / 1440.0),\n      distance_in_months = Math.round(distance_in_minutes / 43200.0),\n      distance_in_years = Math.round(distance_in_days / 365);\n\n  if(distance_in_minutes <= 1) {\n    return (distance_in_minutes === 0) ? \"just now\" : \"1 minute ago\";\n  } else if(distance_in_minutes >= 2 && distance_in_minutes <= 44) {\n    return distance_in_minutes + \" minutes ago\";\n  } else if(distance_in_minutes >= 45 && distance_in_minutes <= 89) {\n    return \"about 1 hour ago\";\n  } else if(distance_in_minutes >= 90 && distance_in_minutes <= 1439) {\n    return \"about \" + distance_in_hours + \" hours ago\";\n  } else if(distance_in_minutes >= 1440 && distance_in_minutes <= 2519) {\n    return \"1 day ago\";\n  } else if(distance_in_minutes >= 2520 && distance_in_minutes <= 43199) {\n    return distance_in_days + \" days ago\";\n  } else if(distance_in_minutes >= 43200 && distance_in_minutes <= 86399) {\n    return \"about 1 month ago\";\n  } else if(distance_in_minutes >= 86400 && distance_in_minutes <= 525599) {\n    return distance_in_months + \" months ago\";\n  } else if(distance_in_months < 13){\n    return \"about 1 year ago\";\n  } else if(distance_in_years < 2) {\n    return \"over 1 year ago\";\n  } else {\n    return distance_in_years + \" years ago\";\n  }\n};\n\nResults = React.createClass({displayName: 'Results',\n    render: function(){\n        var scorecard = this.props.scorecard,\n            test = this.props.test,\n            showing = this.props.showing,\n            description, scorecard_url,\n            result, result_list, display;\n\n        description = testDescription(test);\n        scorecard_url = '#' + routie.lookup('scorecard',\n                                      {project_id: showing.project_id,\n                                       scorecard_id: showing.scorecard_id});\n\n        result_list = test.test_results.map(function(tr){\n            return (TestResult( {key:tr.id, scorecard:scorecard,\n                    test:test, test_result:tr, showing:showing} ));\n        });\n        return (React.DOM.div(null, \n                React.DOM.div( {className:\"row-fluid\"}, \n                  React.DOM.h4(null, React.DOM.a( {href:scorecard_url}, scorecard.name), \" : \", description)\n                ),\n                React.DOM.div( {className:\"row-fluid\"}, \n                  React.DOM.div( {className:\"span3 well\"}, \n                  React.DOM.ul( {className:\"nav nav-list\"}, result_list)\n                  ),\n                  ArtifactDisplay( {showing:showing, test:test} )\n                )\n                ));\n    }\n});\n\nTestResult = React.createClass({displayName: 'TestResult',\n    render: function(){\n        var showing = this.props.showing,\n            scorecard = this.props.scorecard,\n            test = this.props.test,\n            test_result = this.props.test_result,\n            active = (test_result.id.toString() === showing.test_result_id),\n            labelClass = (test_result.status) ? \"label label-success\" : \"label label-important\",\n            labelText = (test_result.status) ? \"Success\" : \"Failure\",\n            liClass = (active) ? \"active\" : \"\",\n            friendlyUrl = friendlyTestUrl(scorecard, test),\n            url;\n        url = '#' + routie.lookup('test_result',\n                            {project_id: showing.project_id,\n                             scorecard_id: showing.scorecard_id,\n                             test_instance_id: friendlyUrl,\n                             test_result_id: test_result.id});\n        return (React.DOM.li( {className:liClass}, \n                  React.DOM.a( {href:url, className:liClass}, \n                    React.DOM.span( {className:labelClass}, labelText),\n                    timeAgoInWords(new Date(test_result.created_at)), \" [\",test_result.long_version,\"]\"\n                  ),\n                  ArtifactList( {showing:showing, test_result:test_result,\n                                friendlyUrl:friendlyUrl, active:active})\n                ));\n    }\n});\n});\n","minispade.register('routes', function(){\n// For initial load\nroutie.navigateToHash = function(){\n    var hash = window.location.hash.substring(1);\n    if(hash === \"\" || hash === undefined)\n        window.location.hash = \"#/\";\n};\n\nfriendlyTestUrl = function(scorecard, test) {\n    var parts = [scorecard.id, test.id, test.name, test.platform];\n    if(test.backend){ parts.push(test.backend); }\n    if(test.upgrade_version){ parts.push(test.upgrade_version); }\n    return encodeURIComponent(parts.join('-'));\n};\n\nextractTestId = function(segment){\n  segment = decodeURIComponent(segment);\n  return segment.split('-')[1];\n};\n\nroutie({\n    'projects /': function(p){\n        // Go to root\n        GiddyUp.showing = {};\n        GiddyUp.help = 'projects';\n        GiddyUp.fetchProjects(GiddyUp.render);\n    },\n    'project /projects/:project_id': function(p){\n        // Load scorecards, display scorecard nav\n        GiddyUp.showing = {project_id: p};\n        GiddyUp.help = 'project';\n        GiddyUp.fetchProjects(function(){\n            var project = GiddyUp.projectsById[p];\n            GiddyUp.fetchScorecards(project, GiddyUp.render);\n        });\n    },\n    'scorecard /projects/:project_id/scorecards/:scorecard_id': function(p,s){\n        // Check if scorecard's matrix is loaded, if not render the\n        // progress bar and start loading them. When it is loaded and\n        // computed, render the matrix.\n        GiddyUp.showing = {project_id: p, scorecard_id: s};\n        GiddyUp.help = 'scorecard';\n        GiddyUp.fetchProjects(function(){\n            var project = GiddyUp.projectsById[p];\n            GiddyUp.fetchScorecards(project, function(scorecards){\n                GiddyUp.fetchMatrix(project.scorecardsById[s], GiddyUp.render);\n            });\n        });\n    },\n    'test_instance /projects/:project_id/scorecards/:scorecard_id/:test_instance_id': function(p,s,ti){\n        // Replace the matrix view with the master/detail view of test\n        // results\n        GiddyUp.showing = {project_id: p, scorecard_id: s,\n                           test_instance_id: extractTestId(ti)};\n        GiddyUp.help = 'test_instance';\n        GiddyUp.fetchProjects(function(){\n            var project = GiddyUp.projectsById[p];\n            GiddyUp.fetchScorecards(project, function(scorecards){\n                GiddyUp.fetchMatrix(project.scorecardsById[s], GiddyUp.render);\n            });\n        });\n    },\n    'test_result /projects/:project_id/scorecards/:scorecard_id/:test_instance_id/:test_result_id': function(p,s,ti,tr){\n        // Load the artifacts for the test result and display them in\n        // the list\n        ti = extractTestId(ti);\n        GiddyUp.showing = {project_id: p, scorecard_id: s,\n                           test_instance_id: ti,\n                           test_result_id: tr};\n        GiddyUp.help = 'test_result';\n        GiddyUp.fetchProjects(function(){\n            var project = GiddyUp.projectsById[p];\n            GiddyUp.fetchScorecards(project, function(scorecards){\n                GiddyUp.fetchMatrix(project.scorecardsById[s], function(scorecard){\n                    GiddyUp.fetchArtifacts(scorecard.testsById[ti].resultsById[tr], GiddyUp.render);\n                });\n            });\n        });\n    },\n    'artifact /projects/:project_id/scorecards/:scorecard_id/:test_instance_id/:test_result_id/artifacts/:artifact_id': function(p,s,ti,tr,a){\n        // Load the artifact body\n        ti = extractTestId(ti);\n        GiddyUp.showing = {project_id: p, scorecard_id: s,\n                           test_instance_id: ti,\n                           test_result_id: tr,\n                           artifact_id: a};\n        GiddyUp.help = 'artifact';\n        GiddyUp.fetchProjects(function(){\n            var project = GiddyUp.projectsById[p];\n            GiddyUp.fetchScorecards(project, function(scorecards){\n                GiddyUp.fetchMatrix(project.scorecardsById[s], function(scorecard){\n                    GiddyUp.fetchArtifacts(scorecard.testsById[ti].resultsById[tr],function(artifacts){\n                        GiddyUp.fetchArtifactContents(scorecard.testsById[ti].resultsById[tr].artifactsById[a], \n                                                      GiddyUp.render);\n                    });\n                });\n            });\n        });\n        GiddyUp.render();\n    }\n});\n});\n","minispade.register('scorecards', function(){\n/** @jsx React.DOM */\nScorecardsNav = React.createClass({displayName: 'ScorecardsNav',\n    getInitialState: function(){\n        return { scorecards: {} };\n    },\n    componentWillMount: function(){\n        var self = this;\n        GiddyUp.fetchScorecards(\n            this.props.project,\n            function(scorecards){\n                self.setState({scorecards: scorecards})\n            });\n    },\n    render: function() {\n        var self = this,\n            links = [],\n            version;\n        for(version in this.state.scorecards){\n            var dropdown = (ScorecardNavGroup( {key:version,\n                            version:version,\n                            showing:this.props.showing,\n                            scorecards:this.state.scorecards[version]} ));\n            links.push([version, dropdown]);\n        }\n        links.sort(GiddyUp.sortBy(0)).reverse();\n        links = links.map(function(l){ return l[1]; });\n        return (\n                React.DOM.div( {className:\"navbar\", style:{marginTop: \"-1px\"}}, \n                  React.DOM.div( {className:\"navbar-inner\"}, \n                    React.DOM.ul( {className:\"nav\"}, links)\n                  )\n                )\n        );\n\n    }\n});\n\nScorecardNavGroup = React.createClass({displayName: 'ScorecardNavGroup',\n    getInitialState: function(){\n        return { dropdown: false, lastEvent: null };\n    },\n    className: function(){\n        var id = this.props.showing.scorecard_id,\n            match = this.props.scorecards.find(function(s){ return (s.id == id); });\n            classes = ['dropdown'];\n        if(this.state.dropdown)\n            classes.push('open');\n        if(match)\n            classes.push('active');\n        return classes.join(' ');\n    },\n    linkText: function(){\n        var id = this.props.showing.scorecard_id,\n            match = this.props.scorecards.find(function(s){ return (s.id == id); });\n        if(match){\n            return match.name;\n        } else {\n            return this.props.version;\n        }\n    },\n    handleClick: function(evt){\n        evt.nativeEvent.guid = GiddyUp.nextGuid();\n        this.setState({ dropdown: (!this.state.dropdown),\n                        lastEvent: evt.nativeEvent.guid });\n        evt.preventDefault();\n    },\n    handleDocumentClick: function(evt) {\n        if(this.state.lastEvent === evt.guid)\n            return;\n        this.setState({dropdown: false, lastEvent: null});\n    },\n    componentDidMount: function(){\n        window.addEventListener('click', this.handleDocumentClick);\n    },\n    componentWillUnmount: function(){\n        window.removeEventListener('click', this.handleDocumentClick);\n    },\n    render: function(){\n        if(this.props.scorecards.length == 1) {\n            return (ScorecardNavLink(\n                    {showing:this.props.showing,\n                    scorecard:this.props.scorecards[0]}\n                    ));\n        } else {\n            var self = this;\n            var classname = this.className();\n            var text = this.linkText();\n            var links = this.props.scorecards.map(function(s){\n                return (\n                        ScorecardNavLink( {scorecard:s,\n                        key:s.id,\n                        showing:self.props.showing}\n                        ));\n            });\n            return (React.DOM.li( {className:classname}, \n                    React.DOM.a( {href:\"#\", className:\"dropdown-toggle\",\n                      onClick:this.handleClick}, \n                      text,\n                       React.DOM.b( {className:\"caret\"})\n                    ),\n                    React.DOM.ul( {className:\"dropdown-menu\"}, links)\n                    ));\n        }\n    }\n});\n\nScorecardNavLink = React.createClass({displayName: 'ScorecardNavLink',\n    render: function(){\n        var active = (this.props.showing.scorecard_id ==\n                      this.props.scorecard.id.toString()),\n            url = '#' + routie.lookup('scorecard', {\n                scorecard_id: this.props.scorecard.id,\n                project_id: this.props.scorecard.project\n            });\n\n        return (React.DOM.li( {className:active ? \"active\" : \"\"}, \n                React.DOM.a( {href:url},  \" \", this.props.scorecard.name, \" \" )\n                ));\n    }\n});\n});\n"]}